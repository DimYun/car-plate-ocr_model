## Обучение OCR

### Данные

Датасет состоит из кропов номеров машин (ГРЗ) 27 стран + двурядные номера 
(примерно 2 000 000 изображений кропов, есть битые и не валидные данные).

Описательный анализ данных и подбор входного размера изображения и бэкбона 
для CRNN приведены в [EDA.ipynb](notebooks/EDA.ipynb).


### Подготовка данных и модели

Перед тем как запускать обучение, необходимо подобрать входной размер 
изображения и бекбон для CRNN. Процедура также приведена [в тетрадке](notebooks/подбор параметров.ipynb) с 
описательным анализом данных.


### Запуск обучения

``` DATA_PATH=/your/data/folder/bar_codes python train.py configs/config.yaml```


### Анализ результатов

[ClearMl для лучшей модели](https://app.clear.ml/projects/cb019a605a934ca1a4d85897c43bec3b/experiments/3b62d34fc96049ee9f82db6c858be152/output/execution). 

[Проверить инференс](notebooks/inference_onnx_convert.ipynb).


### Подготовка окружения

1. Создание и активация окружения
    ```bash
    python3 -m venv venv
    . venv/bin/activate
    ```

2. Установка библиотек
   ```
    make install
   ```
   
3. Запуск линтеров
   ```
   make lint
   ```

### Вопросы

1. Не совсем понятно назначение и связь с исходными данными настроек:   rnn_features_num: 48
  rnn_hidden_size: 64
2. Зачем повторяется num_classes в теле конфига
3. Как правильно регулировать размер входных фич, сейчас поправил nn.GRU(
            input_size=384,  #576,), но кажется это уменьшает 
   предсказательную способность? 
4. Как добавить классификацию региона номера?